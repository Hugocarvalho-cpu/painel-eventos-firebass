<!DOCTYPE html><html>
<head>
  <title>Painel de Eventos</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; background-color: #f4f0fa; color: #333; }
    h1, h2 { color: #5e2b97; }
    label, input, select, button, textarea { display: block; width: 100%; margin-bottom: 10px; }
    input, select, textarea { padding: 8px; border-radius: 6px; border: 1px solid #ccc; }
    button { padding: 10px; background-color: #5e2b97; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background-color: #4a237a; }
    #adminPanel, #loginPanel { display: none; }
    .log { background: #eee; padding: 5px; border-radius: 5px; margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>Painel de Eventos</h1>  <div id="userPanel">
    <h2>Reservar Evento</h2>
    <label>Seu Nick: <input type="text" id="nickInput"></label>
    <label>Eventos Disponíveis:</label>
    <select id="eventSelect"></select>
    <button onclick="reserveEvent()">Reservar</button><h3>Sugerir Evento</h3>
<label>Nome do Evento: <input type="text" id="suggestInput"></label>
<button onclick="suggestEvent()">Sugerir</button>

<button onclick="showLogin()">Login Admin</button>

  </div>  <div id="loginPanel">
    <h2>Login Admin</h2>
    <label>Usuário: <input type="text" id="adminUser"></label>
    <label>Senha: <input type="password" id="adminPass"></label>
    <button onclick="loginAdmin()">Entrar</button>
    <button onclick="showUserPanel()">Cancelar</button>
  </div>  <div id="adminPanel">
    <h2>Painel Admin</h2>
    <label>Adicionar Evento: <input type="text" id="newEvent"></label>
    <button onclick="addEvent()">Adicionar</button>
    <button onclick="resetAll()">Resetar Tudo</button>
    <button onclick="resetReservations()">Resetar Reservas</button><h3>Editar Reserva</h3>
<label>ID do Evento: <input type="text" id="editId"></label>
<label>Novo Nick: <input type="text" id="editNick"></label>
<button onclick="editNick()">Alterar Nick</button>

<h3>Gerenciar Eventos</h3>
<label>ID para excluir: <input type="text" id="deleteId"></label>
<button onclick="deleteEvent()">Excluir</button>
<label>ID para desbloquear: <input type="text" id="unlockId"></label>
<button onclick="unlockEvent()">Desbloquear Evento</button>

<h3>Logs de Reservas</h3>
<div id="logs"></div>

<h3>Logs de Sugestões</h3>
<div id="suggestions"></div>

<button onclick="clearLogs()">Limpar Logs</button>
<button onclick="logoutAdmin()">Logout</button>

  </div>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA7R1solmwmOAbHCs2kWpMgDH05s4H-5e8",
      authDomain: "paineleventos-eb268.firebaseapp.com",
      databaseURL: "https://paineleventos-eb268-default-rtdb.firebaseio.com",
      projectId: "paineleventos-eb268",
      storageBucket: "paineleventos-eb268.appspot.com",
      messagingSenderId: "1058039759873",
      appId: "1:1058039759873:web:2b504e42531517be60ec00"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let isAdmin = false;
    const adminUser = "admin";
    const adminPass = "adm11";

    function showLogin() {
      document.getElementById('userPanel').style.display = 'none';
      document.getElementById('loginPanel').style.display = 'block';
      document.getElementById('adminPanel').style.display = 'none';
    }
    function showUserPanel() {
      document.getElementById('userPanel').style.display = 'block';
      document.getElementById('loginPanel').style.display = 'none';
      document.getElementById('adminPanel').style.display = 'none';
    }
    function showAdminPanel() {
      document.getElementById('userPanel').style.display = 'none';
      document.getElementById('loginPanel').style.display = 'none';
      document.getElementById('adminPanel').style.display = 'block';
      loadEvents();
      loadLogs();
      loadSuggestions();
    }

    function loginAdmin() {
      const user = document.getElementById('adminUser').value;
      const pass = document.getElementById('adminPass').value;
      if(user === adminUser && pass === adminPass) {
        isAdmin = true;
        showAdminPanel();
      } else alert("Usuário ou senha incorretos!");
    }
    function logoutAdmin() {
      isAdmin = false;
      showUserPanel();
    }

    function loadEvents() {
      const select = document.getElementById('eventSelect');
      select.innerHTML = '';
      db.ref('events').once('value').then(snapshot => {
        const events = snapshot.val() || {};
        for(let key in events) {
          const event = events[key];
          const option = document.createElement('option');
          option.value = key;
          option.text = event.name + (event.reservedBy ? ` (Reservado por ${event.reservedBy})` : '') + (event.blocked ? " [Bloqueado]" : "");
          if (!event.blocked) select.appendChild(option);
        }
      });
    }

    function addEvent() {
      const name = document.getElementById('newEvent').value.trim();
      if(!name) return alert("Digite um nome!");
      db.ref('events').once('value').then(snapshot => {
        const events = snapshot.val() || {};
        for (let key in events) {
          if(events[key].name.toLowerCase() === name.toLowerCase()) return alert("Evento já existe!");
        }
        const newKey = db.ref('events').push().key;
        db.ref('events/' + newKey).set({name: name, reservedBy: null, blocked: false}).then(() => {
          alert("Evento adicionado!");
          loadEvents();
        });
      });
    }

    function reserveEvent() {
      const nick = document.getElementById('nickInput').value.trim();
      const eventKey = document.getElementById('eventSelect').value;
      if(!nick || !eventKey) return alert("Complete todos os campos!");
      db.ref('events/' + eventKey).once('value').then(snapshot => {
        const event = snapshot.val();
        if(event.reservedBy) return alert("Evento já reservado!");
        db.ref('events/' + eventKey + '/reservedBy').set(nick);
        const log = `${nick} reservou o evento "${event.name}"`;
        db.ref('logs').push(log);
        loadEvents();
      });
    }

    function deleteEvent() {
      const id = document.getElementById('deleteId').value;
      if(confirm("Tem certeza?")) db.ref('events/' + id).remove().then(loadEvents);
    }

    function unlockEvent() {
      const id = document.getElementById('unlockId').value;
      db.ref('events/' + id + '/blocked').set(true);
      loadEvents();
    }

    function editNick() {
      const id = document.getElementById('editId').value;
      const nick = document.getElementById('editNick').value;
      db.ref('events/' + id + '/reservedBy').set(nick).then(() => alert("Nick atualizado"));
    }

    function resetAll() {
      if(confirm("Apagar todos os eventos?")) db.ref('events').remove().then(loadEvents);
    }

    function resetReservations() {
      db.ref('events').once('value').then(snapshot => {
        const updates = {};
        snapshot.forEach(child => {
          updates[child.key + '/reservedBy'] = null;
        });
        db.ref('events').update(updates);
        alert("Reservas resetadas!");
        loadEvents();
      });
    }

    function suggestEvent() {
      const nick = document.getElementById('nickInput').value.trim();
      const suggest = document.getElementById('suggestInput').value.trim();
      if(nick && suggest) db.ref('suggestions').push(`${nick} sugeriu: ${suggest}`);
      document.getElementById('suggestInput').value = '';
    }

    function loadLogs() {
      db.ref('logs').once('value').then(snapshot => {
        const logs = snapshot.val() || {};
        const logDiv = document.getElementById('logs');
        logDiv.innerHTML = '';
        for(let key in logs) logDiv.innerHTML += `<div class='log'>${logs[key]}</div>`;
      });
    }

    function loadSuggestions() {
      db.ref('suggestions').once('value').then(snapshot => {
        const suggestions = snapshot.val() || {};
        const suggDiv = document.getElementById('suggestions');
        suggDiv.innerHTML = '';
        for(let key in suggestions) suggDiv.innerHTML += `<div class='log'>${suggestions[key]}</div>`;
      });
    }

    function clearLogs() {
      db.ref('logs').remove();
      db.ref('suggestions').remove();
      loadLogs();
      loadSuggestions();
    }

    showUserPanel();
    loadEvents();
  </script></body>
</html>
